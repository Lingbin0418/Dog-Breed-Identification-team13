# Dog-Breed-Identification-team13

## 📘 專案簡介

本專案旨在參與 Kaggle 的「Dog Breed Identification」競賽，目標是建立一個機器學習模型，能夠判斷一張狗狗圖片所屬的品種。透過深度學習模型訓練與優化，提升圖像辨識的準確度與穩定性。

## 📁 專案結構

```
├── data/ # 資料集
├── 不同訓練結果/ # 各版本訓練結果
├── 最高分程式碼完整版/ # 最佳模型完整程式碼
└── README.md # 專案說明文件
```


## 📂 Kaggle 提供的資料集（data/）

- `train`：訓練資料集  
- `test`：測試資料集
- `label.csv`：標籤檔樣式
- `sample_submission.csv`：提交格式範例

## 🧪 不同訓練結果（不同訓練結果/）

此資料夾包含多個訓練版本的結果，每個版本皆包含：

- `.ipynb`：Jupyter Notebook 格式的訓練程式碼  
- 模型輸出結果與可視化圖表  

使用者可參考不同版本的訓練策略與結果，進行比較與分析。

## 📊 訓練配置與效能分析表

| 配置編號 | Kaggle 分數 | 學習率排程 | 最大序列長度 | LoRA | 批量大小變化 | Deberta 平均 ROC-AUC | Roberta 平均 ROC-AUC | Roberta 穩定性 | 分析結果 |
|----------|----------------|------------|----------------|------|----------------|------------------------|------------------------|----------------|------------|
| 15       | 0.83144        | Linear     | 128            | 是   | 8,16,16         | 0.5384                 | 0.5365                 | 穩定           | LoRA 顯著提升 Roberta 穩定性，避免災難性失敗。 |
| 16       | 0.84921        | Linear     | 128            | 否   | 8,16,16         | 0.5406                 | 0.5385                 | 不穩定（全預測負類） | 無 LoRA 導致 Roberta 災難性失敗。 |
| 17       | 0.85167        | Cosine     | 128            | 否   | 8,16,16         | 0.5368                 | 0.5285                 | 不穩定（部分峰值） | Roberta 效能兩極，有潛力但風險大。 |
| 18       | 0.84094        | Cosine     | 64             | 否   | 8,16,16         | 0.5367                 | 0.5335                 | 不穩定（偏差更大） | 序列長度縮短未改善效能，失敗樣態更多。 |
| 20       | —              | Cosine     | 128            | 否   | 16,32,32        | —                      | 0.5392                 | 穩定           | 批量大小調整為關鍵穩定因子。 |

## 🏆 最高分程式碼完整版（最高分程式碼完整版/）

此資料夾包含兩個子資料夾 `py/` 和 `ipynb/`，兩者內容相同，僅格式不同，方便使用者依照喜好選擇。

### 📂 py/ 資料夾內容

- `No_17(score_0_85167).py`：第 17 版完整訓練腳本（最高分模型）  
- `資料探索.py`：資料探索程式  
- `requirements.txt`：Python 套件需求清單  
- `train.csv`、`test.csv`、`sample_submission.csv`

### 📂 ipynb/ 資料夾內容

- `No_17(score_0_85167).ipynb`：第 17 版完整 Jupyter Notebook（最高分模型）  
- `資料探索.ipynb`：資料探索筆記本  
- 其他檔案與 `py/` 相同

## 🚀 使用方式

### 安裝所需套件

```bash
pip install -r requirements.txt
```

以上為本次 Kaggle 專案之完整內容說明，歡迎交流指教！

## 模型架構
使用預訓練的 EfficientNet-B0 模型作為 backbone，並自訂最後的全連接層如下：

- 替換 EfficientNet 的分類頭為新的 Linear 層，輸出類別數為 120
- 輸出經過 Softmax 層計算每個類別的機率

## 執行環境
- Python 3.x  
- PyTorch  
- torchvision  
- pandas, sklearn  
- PIL  
- CUDA（Kaggle 提供 GPU）

## 備註
- 測試集預測前請移除 `.jpg` 副檔名以符合提交格式


